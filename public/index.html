<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Community Library | Dashboard</title>
    <style>
        body { font-family: sans-serif; margin: 20px; line-height: 1.6; }
        nav { margin-bottom: 20px; padding: 10px; background: #f4f4f4; }
        .book-card { border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 5px; }
        .stats-btn { background: #28a745; color: white; border: none; padding: 5px 10px; cursor: pointer; }
    </style>
</head>
<body>
    <nav>
        <strong>ðŸ“š Library System</strong> | 
        <a href="index.html">Home</a> | 
        <a href="search.html">Manage Tags</a> | 
        <a href="admin.html">Admin Panel</a> | 
        <a href="stats.html">Analytics</a>
    </nav>

    <h2>Donate a Book</h2>
    <div class="book-card">
        <input id="title" placeholder="Book Title">
        <input id="author" placeholder="Author Name">
        <button onclick="addBook()">Add to Library</button>
    </div>

    <h2>Current Inventory</h2>
    <div id="bookList"></div>

    <script>
        async function loadBooks() {
            const res = await fetch('/api/books');
            const books = await res.json();
            document.getElementById('bookList').innerHTML = books.map(b => `
                <div class="book-card">
                    <h3>${b.title}</h3>
                    <p>Author: ${b.author} | Status: <strong>${b.status}</strong></p>
                    <button class="stats-btn" onclick="exchange('${b._id}')">Exchange This Book</button>
                </div>
            `).join('');
        }

        async function addBook() {
            const title = document.getElementById('title').value;
            const author = document.getElementById('author').value;
            await fetch('/api/books', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ title, author })
            });
            loadBooks();
        }

        async function exchange(id) {
            await fetch(`/api/books/${id}/exchange`, { method: 'PATCH' });
            loadBooks();
        }

        loadBooks();
    </script>
</body>
</html>