<!DOCTYPE html>
<html>
<body>
    <nav><a href="index.html">Home</a> | <a href="search.html">Tags</a> | <a href="admin.html">Admin</a> | <a href="stats.html">Stats</a></nav>
    <h2>Manage Book Tags</h2>
    <div id="tagList"></div>
    <script>
        async function load() {
            const res = await fetch('/api/books');
            const books = await res.json();
            document.getElementById('tagList').innerHTML = books.map(b => `
                <div>
                    <strong>${b.title}</strong> - Tags: ${b.tags.join(', ')} <br>
                    <input id="i-${b._id}" placeholder="New tag">
                    <button onclick="addTag('${b._id}')">Add Tag</button>
                </div><hr>`).join('');
        }
        async function addTag(id) {
            const tag = document.getElementById('i-'+id).value;
            await fetch(`/api/books/${id}/tags`, { method: 'PATCH', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ tag }) });
            load();
        }
        load();
    </script>
</body>
</html>